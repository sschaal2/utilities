<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>UtilitiesLibrary: data_sets.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_298f87db2c1cba43efabc3c5f4fa9ff0.html">Volumes</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_55c01fe2c4e33086155b7af166379d0d.html">duerer</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e649ffe43dddcd8c18e8978de920ceca.html">clmc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a11192148bba0ec087a757509aa6dd8a.html">prog</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a724f2ce3c559fa1ec5bcb09e2ce96ed.html">utilities</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_9b95c9b76970a94ba51f3464999d1cac.html">src</a>
  </div>
</div>
<div class="contents">
<h1>data_sets.c</h1><a href="data__sets_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00017"></a>00017 <span class="preprocessor">#include "stdio.h"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "math.h"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "utility.h"</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include "mdefs.h"</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include "<a class="code" href="data__sets_8h.html">data_sets.h</a>"</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 void (*generating_function[MAX_GENERATING_FUNCTIONS+1])(<span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y);
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">/*!*****************************************************************************</span>
<a name="l00029"></a>00029 <span class="comment"> *******************************************************************************</span>
<a name="l00030"></a>00030 <span class="comment"> \note  draw_data_point</span>
<a name="l00031"></a>00031 <span class="comment"> \date  January, 1994</span>
<a name="l00032"></a>00032 <span class="comment"> </span>
<a name="l00033"></a>00033 <span class="comment"> \remarks </span>
<a name="l00034"></a>00034 <span class="comment"> </span>
<a name="l00035"></a>00035 <span class="comment"> draws a new training data point according to various critera</span>
<a name="l00036"></a>00036 <span class="comment"> </span>
<a name="l00037"></a>00037 <span class="comment"> *******************************************************************************</span>
<a name="l00038"></a>00038 <span class="comment"> Function Parameters: [in]=input,[out]=output</span>
<a name="l00039"></a>00039 <span class="comment"> </span>
<a name="l00040"></a>00040 <span class="comment"> \param[in]     X      : the data matrix with input data</span>
<a name="l00041"></a>00041 <span class="comment"> \param[in]     Y      : the data matrix with output data</span>
<a name="l00042"></a>00042 <span class="comment"> \param[in]     n_data : number of data points in matrices</span>
<a name="l00043"></a>00043 <span class="comment"> \param[in]     n_in   : number of inputs</span>
<a name="l00044"></a>00044 <span class="comment"> \param[in]     n_out  : number of outputs</span>
<a name="l00045"></a>00045 <span class="comment"> \param[in]     index_function : index function to be used for GENERATING_FUNCTION</span>
<a name="l00046"></a>00046 <span class="comment"> \param[in]     sampling_method : RANDOM_SAMPLING, SEQUENTIAL_SAMPLING,</span>
<a name="l00047"></a>00047 <span class="comment">                      GENERATING_FUNCTION, PSEUDO_RANDOM_SAMPLING</span>
<a name="l00048"></a>00048 <span class="comment"> \param[in]     ind    : for pseudo random sampling ptr to an index array. Pass a variable</span>
<a name="l00049"></a>00049 <span class="comment">             initialized with NULL to make this program assign it</span>
<a name="l00050"></a>00050 <span class="comment">             appropriately                    </span>
<a name="l00051"></a>00051 <span class="comment"> \param[out]    x      : the output vector</span>
<a name="l00052"></a>00052 <span class="comment"> \param[out]    y      : the input vector</span>
<a name="l00053"></a>00053 <span class="comment"> \param[out]    current_data_point : the current data point</span>
<a name="l00054"></a>00054 <span class="comment"> </span>
<a name="l00055"></a>00055 <span class="comment"> </span>
<a name="l00056"></a>00056 <span class="comment"> ******************************************************************************/</span>
<a name="l00057"></a>00057 <span class="keywordtype">int</span>
<a name="l00058"></a><a class="code" href="data__sets_8h.html#f1857a7907467ed9aac86e51f9f96ebe">00058</a> <a class="code" href="data__sets_8c.html#f1857a7907467ed9aac86e51f9f96ebe">draw_data_point</a>(<span class="keywordtype">double</span> **X, <span class="keywordtype">double</span> **Y, <span class="keywordtype">int</span> n_data, <span class="keywordtype">int</span> n_in, <span class="keywordtype">int</span> n_out,
<a name="l00059"></a>00059                 <span class="keywordtype">int</span> sampling_method, <span class="keywordtype">int</span> index_function, <span class="keywordtype">int</span> **ind,
<a name="l00060"></a>00060                 <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y, <span class="keywordtype">int</span> *current_data_point)
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063 
<a name="l00064"></a>00064   <span class="keywordtype">int</span> i;
<a name="l00065"></a>00065   <span class="keyword">static</span> <span class="keywordtype">int</span> firsttime = TRUE;
<a name="l00066"></a>00066   <span class="keywordtype">int</span> num;
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (firsttime) {
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     firsttime = FALSE;
<a name="l00072"></a>00072     
<a name="l00073"></a>00073     <span class="comment">/* define the generating functions */</span>
<a name="l00074"></a>00074     
<a name="l00075"></a>00075     generating_function[1] = cross_3_noise;
<a name="l00076"></a>00076     generating_function[2] = cross_8_noise;
<a name="l00077"></a>00077     generating_function[3] = cross;
<a name="l00078"></a>00078     generating_function[4] = squiggle;
<a name="l00079"></a>00079     generating_function[5] = inv_dyn_2DOF;
<a name="l00080"></a>00080     generating_function[6] = cross_nonsense_dim;
<a name="l00081"></a>00081     generating_function[7] = cross_2_noise_1;
<a name="l00082"></a>00082     generating_function[8] = cross_2_noise_01;
<a name="l00083"></a>00083     generating_function[9] = cross_2_noise_001;
<a name="l00084"></a>00084     generating_function[10] = cross_2_brown_10;
<a name="l00085"></a>00085     generating_function[11] = cross_2_brown_25;
<a name="l00086"></a>00086     generating_function[12] = cross_2_brown_50;
<a name="l00087"></a>00087     generating_function[13] = cross_2_noise_2_brown;
<a name="l00088"></a>00088     generating_function[14] = cross_1_noise_1_brown_1_duplicate;
<a name="l00089"></a>00089     generating_function[15] = cross1;
<a name="l00090"></a>00090     generating_function[16] = cross2;
<a name="l00091"></a>00091     generating_function[17] = cross3;
<a name="l00092"></a>00092     generating_function[18] = cross10d;
<a name="l00093"></a>00093     generating_function[19] = cross10d_10_noise;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   
<a name="l00096"></a>00096   }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">switch</span> (sampling_method) {
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="keywordflow">case</span> RANDOM_SAMPLING:
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     *current_data_point = (int) <a class="code" href="utility_8c.html#9961ec338692d5625694e8caca34953d">random_number</a>(1,n_data);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <span class="keywordflow">for</span> (i=1; i&lt;=n_in; ++i) {
<a name="l00105"></a>00105       x[i] = X[*current_data_point][i];
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107                 
<a name="l00108"></a>00108     <span class="keywordflow">for</span> (i=1; i&lt;=n_out; ++i) {
<a name="l00109"></a>00109       y[i] = Y[*current_data_point][i];
<a name="l00110"></a>00110     }
<a name="l00111"></a>00111                 
<a name="l00112"></a>00112     <span class="keywordflow">break</span>;
<a name="l00113"></a>00113     
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">case</span> SEQUENTIAL_SAMPLING:
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (++*current_data_point &gt; n_data) *current_data_point = 1;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="keywordflow">for</span> (i=1; i&lt;=n_in; ++i) {
<a name="l00120"></a>00120       x[i] = X[*current_data_point][i];
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122                 
<a name="l00123"></a>00123     <span class="keywordflow">for</span> (i=1; i&lt;=n_out; ++i) {
<a name="l00124"></a>00124       y[i] = Y[*current_data_point][i];
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     <span class="keywordflow">break</span>;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00130"></a>00130   <span class="keywordflow">case</span> GENERATING_FUNCTION:
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     (*generating_function[index_function])(x,y);
<a name="l00133"></a>00133 
<a name="l00134"></a>00134     <span class="keywordflow">break</span>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   <span class="keywordflow">case</span> PSEUDO_RANDOM_SAMPLING:
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="keywordflow">if</span> ( (*ind) == NULL) {
<a name="l00140"></a>00140       (*ind)    = my_ivector(0,n_data);
<a name="l00141"></a>00141       (*ind)[0] = n_data;
<a name="l00142"></a>00142       <span class="keywordflow">for</span> (i=1; i&lt;=n_data; ++i) {
<a name="l00143"></a>00143         (*ind)[i]=i;
<a name="l00144"></a>00144       }
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <span class="comment">/* this rearanges the data array a lot, but it will ensure that</span>
<a name="l00148"></a>00148 <span class="comment">       each epoch each data point is exactly used once, with the</span>
<a name="l00149"></a>00149 <span class="comment">       additional randomization from swapping the index variables */</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     num = <a class="code" href="utility_8c.html#9961ec338692d5625694e8caca34953d">random_number</a>(1,(*ind)[0]);
<a name="l00152"></a>00152     *current_data_point = (*ind)[num];
<a name="l00153"></a>00153     (*ind)[num] = (*ind)[(*ind)[0]];
<a name="l00154"></a>00154     (*ind)[(*ind)[0]] = *current_data_point;
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (--((*ind)[0]) &lt; 1) (*ind)[0]=n_data;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keywordflow">for</span> (i=1; i&lt;=n_in; ++i) {
<a name="l00158"></a>00158       x[i] = X[*current_data_point][i];
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160                 
<a name="l00161"></a>00161     <span class="keywordflow">for</span> (i=1; i&lt;=n_out; ++i) {
<a name="l00162"></a>00162       y[i] = Y[*current_data_point][i];
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     
<a name="l00165"></a>00165     <span class="keywordflow">break</span>;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <span class="keywordflow">default</span>:
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <span class="keywordflow">return</span> FALSE;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171   }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   <span class="keywordflow">return</span> TRUE;
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="comment">/*****************************************************************************</span>
<a name="l00180"></a>00180 <span class="comment"> ******************************************************************************</span>
<a name="l00181"></a>00181 <span class="comment"></span>
<a name="l00182"></a>00182 <span class="comment"> all the generating functions are currently here</span>
<a name="l00183"></a>00183 <span class="comment"> </span>
<a name="l00184"></a>00184 <span class="comment"> *****************************************************************************/</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="keywordtype">void</span>
<a name="l00187"></a>00187 squiggle(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 {
<a name="l00190"></a>00190 
<a name="l00191"></a>00191   <span class="keywordtype">int</span> i;
<a name="l00192"></a>00192   <span class="keywordtype">int</span> n = 0;
<a name="l00193"></a>00193   <span class="keywordtype">double</span> aux;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   in[++n] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.5,0.2887);
<a name="l00196"></a>00196   in[++n] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.5,0.2887);
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   aux     = in[1]-.5;
<a name="l00199"></a>00199   out[1]  = (in[2]-.5) * sin(30.* Pi * in[1]* sin(sqr(aux)*aux));
<a name="l00200"></a>00200   out[1] += <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(0.0,0.02);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="keywordtype">void</span>
<a name="l00205"></a>00205 cross(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="keywordtype">int</span> n=0;
<a name="l00210"></a>00210   <span class="keywordtype">double</span> val=0.0;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   cross_n_noise_val(in, out, n, val);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="keywordtype">void</span>
<a name="l00218"></a>00218 cross10d(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="keywordtype">int</span> i,j;
<a name="l00223"></a>00223   <span class="keywordtype">int</span> n=0;
<a name="l00224"></a>00224   <span class="keywordtype">double</span> val=0.0;
<a name="l00225"></a>00225   <span class="keyword">static</span> <span class="keywordtype">int</span> firsttime=TRUE;
<a name="l00226"></a>00226   <span class="keyword">static</span> <span class="keywordtype">double</span> **R;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228   <span class="keywordflow">if</span> (firsttime) {
<a name="l00229"></a>00229     <span class="keywordtype">double</span> T[]={0,
<a name="l00230"></a>00230    1.5866155e-01,  -4.0970565e-01,   1.2437669e-01,  -4.7004816e-01,  -4.5033935e-02,   3.2980265e-01,  -3.1433783e-01,   4.4596580e-01,  -3.5238434e-01,   1.9464489e-01,
<a name="l00231"></a>00231    5.3154002e-02,  -3.4126019e-02,   8.1903780e-01,   2.8636308e-01,  -1.8599783e-01,  -1.1114280e-01,  -2.5427668e-01,   1.3373057e-01,   1.1058119e-01,  -3.1853842e-01,
<a name="l00232"></a>00232   -3.7785070e-01,  -9.8121296e-02,  -9.9138898e-02,  -6.7912728e-03,   1.3497418e-01,  -4.3836002e-01,  -1.2064505e-01,   5.7284087e-01,   4.6629616e-01,   2.5925832e-01,
<a name="l00233"></a>00233    4.1026930e-01,  -4.1175361e-01,  -1.8141995e-01,   4.7971368e-01,  -7.1323546e-02,  -3.7385908e-01,   2.8983030e-01,   2.3907950e-01,  -3.3627133e-01,   1.7237891e-03,
<a name="l00234"></a>00234   -2.3904578e-01,  -1.3020234e-01,  -3.0963723e-01,  -2.7410899e-01,  -5.4349236e-01,  -1.6451788e-01,  -2.3083771e-02,   7.7132581e-02,  -2.6421191e-02,  -6.5212197e-01,
<a name="l00235"></a>00235    8.1315376e-02,  -4.8628922e-01,   1.2277770e-01,  -1.0765958e-01,   7.5792744e-02,   3.5251906e-01,   5.4723384e-01,  -1.0724859e-02,   5.3014852e-01,  -1.3997883e-01,
<a name="l00236"></a>00236    1.1994873e-01,   1.2055965e-01,  -1.7107656e-01,   7.7250840e-02,   6.8490260e-01,   1.4187253e-01,  -1.5241727e-01,   2.8092646e-01,  -3.6416354e-02,  -5.8578713e-01,
<a name="l00237"></a>00237    2.4292079e-01,  -3.3051703e-01,   7.6884381e-02,  -4.0062676e-01,   2.9464768e-01,  -5.4045122e-01,  -2.3055004e-01,  -4.7122965e-01,   9.2444517e-02,  -5.1705867e-02,
<a name="l00238"></a>00238    3.7755380e-01,   5.0715076e-01,   1.9479501e-01,  -4.5133975e-01,  -4.4277090e-02,  -2.5487221e-01,   4.4956833e-01,   2.9802336e-01,  -1.7302781e-02,  -2.1195931e-02,
<a name="l00239"></a>00239   -6.1742121e-01,  -1.3190896e-01,   2.9477572e-01,  -9.9880915e-02,   2.8473480e-01,  -1.3578056e-01,   3.9935511e-01,  -4.5448028e-02,  -4.9107994e-01,  -4.7982701e-02};
<a name="l00240"></a>00240                   
<a name="l00241"></a>00241     firsttime = FALSE;
<a name="l00242"></a>00242     R = my_matrix(1,10,1,10);
<a name="l00243"></a>00243     
<a name="l00244"></a>00244     <span class="keywordflow">for</span> (i=1; i&lt;=10; ++i) {
<a name="l00245"></a>00245       <span class="keywordflow">for</span> (j=1; j&lt;=10; ++j) {
<a name="l00246"></a>00246         R[i][j] = T[10*(i-1)+j];
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249  
<a name="l00250"></a>00250   }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252   cross_n_noise_val(in, out, n, val);
<a name="l00253"></a>00253   <span class="keywordflow">for</span> (i=3; i&lt;=10; ++i) in[i]=0.0;
<a name="l00254"></a>00254   <a class="code" href="utility_8c.html#89526896ab3b37ed2c247f5587b8a4fe">mat_vec_mult</a>(R,in,in);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="keywordtype">void</span>
<a name="l00260"></a>00260 cross10d_10_noise(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 {
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   <span class="keywordtype">int</span> i,j;
<a name="l00265"></a>00265   <span class="keywordtype">int</span> n=12;
<a name="l00266"></a>00266   <span class="keywordtype">double</span> val=0.025;
<a name="l00267"></a>00267   <span class="keyword">static</span> <span class="keywordtype">int</span> firsttime=TRUE;
<a name="l00268"></a>00268   <span class="keyword">static</span> <span class="keywordtype">double</span> **R;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   <span class="keywordflow">if</span> (firsttime) {
<a name="l00271"></a>00271     <span class="keywordtype">double</span> T[]={0,
<a name="l00272"></a>00272    1.5866155e-01,  -4.0970565e-01,   1.2437669e-01,  -4.7004816e-01,  -4.5033935e-02,   3.2980265e-01,  -3.1433783e-01,   4.4596580e-01,  -3.5238434e-01,   1.9464489e-01,
<a name="l00273"></a>00273    5.3154002e-02,  -3.4126019e-02,   8.1903780e-01,   2.8636308e-01,  -1.8599783e-01,  -1.1114280e-01,  -2.5427668e-01,   1.3373057e-01,   1.1058119e-01,  -3.1853842e-01,
<a name="l00274"></a>00274   -3.7785070e-01,  -9.8121296e-02,  -9.9138898e-02,  -6.7912728e-03,   1.3497418e-01,  -4.3836002e-01,  -1.2064505e-01,   5.7284087e-01,   4.6629616e-01,   2.5925832e-01,
<a name="l00275"></a>00275    4.1026930e-01,  -4.1175361e-01,  -1.8141995e-01,   4.7971368e-01,  -7.1323546e-02,  -3.7385908e-01,   2.8983030e-01,   2.3907950e-01,  -3.3627133e-01,   1.7237891e-03,
<a name="l00276"></a>00276   -2.3904578e-01,  -1.3020234e-01,  -3.0963723e-01,  -2.7410899e-01,  -5.4349236e-01,  -1.6451788e-01,  -2.3083771e-02,   7.7132581e-02,  -2.6421191e-02,  -6.5212197e-01,
<a name="l00277"></a>00277    8.1315376e-02,  -4.8628922e-01,   1.2277770e-01,  -1.0765958e-01,   7.5792744e-02,   3.5251906e-01,   5.4723384e-01,  -1.0724859e-02,   5.3014852e-01,  -1.3997883e-01,
<a name="l00278"></a>00278    1.1994873e-01,   1.2055965e-01,  -1.7107656e-01,   7.7250840e-02,   6.8490260e-01,   1.4187253e-01,  -1.5241727e-01,   2.8092646e-01,  -3.6416354e-02,  -5.8578713e-01,
<a name="l00279"></a>00279    2.4292079e-01,  -3.3051703e-01,   7.6884381e-02,  -4.0062676e-01,   2.9464768e-01,  -5.4045122e-01,  -2.3055004e-01,  -4.7122965e-01,   9.2444517e-02,  -5.1705867e-02,
<a name="l00280"></a>00280    3.7755380e-01,   5.0715076e-01,   1.9479501e-01,  -4.5133975e-01,  -4.4277090e-02,  -2.5487221e-01,   4.4956833e-01,   2.9802336e-01,  -1.7302781e-02,  -2.1195931e-02,
<a name="l00281"></a>00281   -6.1742121e-01,  -1.3190896e-01,   2.9477572e-01,  -9.9880915e-02,   2.8473480e-01,  -1.3578056e-01,   3.9935511e-01,  -4.5448028e-02,  -4.9107994e-01,  -4.7982701e-02};
<a name="l00282"></a>00282                   
<a name="l00283"></a>00283     firsttime = FALSE;
<a name="l00284"></a>00284     R = my_matrix(1,10,1,10);
<a name="l00285"></a>00285     
<a name="l00286"></a>00286     <span class="keywordflow">for</span> (i=1; i&lt;=10; ++i) {
<a name="l00287"></a>00287       <span class="keywordflow">for</span> (j=1; j&lt;=10; ++j) {
<a name="l00288"></a>00288         R[i][j] = T[10*(i-1)+j];
<a name="l00289"></a>00289       }
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291  
<a name="l00292"></a>00292   }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   cross_n_noise_val(in, out, n, val);
<a name="l00295"></a>00295   <span class="keywordflow">for</span> (i=20; i&gt;=10; --i)
<a name="l00296"></a>00296     in[i] = in[i-8];
<a name="l00297"></a>00297   <span class="keywordflow">for</span> (i=3; i&lt;=10; ++i) in[i]=0.0;
<a name="l00298"></a>00298   <a class="code" href="utility_8c.html#392aa2124c9ae18e8c6f7c347b5a199e">mat_vec_mult_size</a>(R,10,10,in,10,in);
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="keywordtype">void</span>
<a name="l00304"></a>00304 cross1(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 {
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   <span class="keywordtype">int</span> n=0;
<a name="l00309"></a>00309   <span class="keywordtype">double</span> val=0.0;
<a name="l00310"></a>00310   <span class="keyword">static</span> <span class="keywordtype">double</span> r_max[3]={0.0,-0.2, 1.};
<a name="l00311"></a>00311   <span class="keyword">static</span> <span class="keywordtype">double</span> r_min[3]={0.0,-1.0,-1.};
<a name="l00312"></a>00312 
<a name="l00313"></a>00313   cross_region(in, out, r_min,r_max);
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="keywordtype">void</span>
<a name="l00319"></a>00319 cross2(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 {
<a name="l00322"></a>00322 
<a name="l00323"></a>00323   <span class="keywordtype">int</span> n=0;
<a name="l00324"></a>00324   <span class="keywordtype">double</span> val=0.0;
<a name="l00325"></a>00325   <span class="keyword">static</span> <span class="keywordtype">double</span> r_max[3]={0.0, 0.4, 1.};
<a name="l00326"></a>00326   <span class="keyword">static</span> <span class="keywordtype">double</span> r_min[3]={0.0,-0.4,-1.};
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   cross_region(in, out, r_min,r_max);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 <span class="keywordtype">void</span>
<a name="l00334"></a>00334 cross3(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <span class="keywordtype">int</span> n=0;
<a name="l00339"></a>00339   <span class="keywordtype">double</span> val=0.0;
<a name="l00340"></a>00340   <span class="keyword">static</span> <span class="keywordtype">double</span> r_max[3]={0.0, 1.0, 1.};
<a name="l00341"></a>00341   <span class="keyword">static</span> <span class="keywordtype">double</span> r_min[3]={0.0, 0.2,-1.};
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   cross_region(in, out, r_min,r_max);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="keywordtype">void</span>
<a name="l00349"></a>00349 cross_nonsense_dim(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352 
<a name="l00353"></a>00353   <span class="keywordtype">int</span> n=2;
<a name="l00354"></a>00354   <span class="keywordtype">double</span> val=0.01;
<a name="l00355"></a>00355   <span class="keyword">static</span> <span class="keywordtype">double</span> ttime=0;
<a name="l00356"></a>00356   <span class="keywordtype">double</span> dt = 0.01;
<a name="l00357"></a>00357   <span class="keywordtype">double</span> tau1=100.0,tau2=1.0;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359   cross_n_noise_val(in, out, n, val);
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   n = 4;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363   ttime += dt;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   in[++n] = sin(2.*Pi/tau1*ttime)*0.1;
<a name="l00366"></a>00366   in[++n] = sin(2.*Pi/tau2*ttime)*0.2;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="keywordtype">void</span>
<a name="l00371"></a>00371 cross_8_noise(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 {
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   <span class="keywordtype">int</span> n=8;
<a name="l00376"></a>00376   <span class="keywordtype">double</span> val=0.025;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378   cross_n_noise_val(in, out, n, val);
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00381"></a>00381 <span class="keywordtype">void</span>
<a name="l00382"></a>00382 cross_3_noise(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 {
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="keywordtype">int</span> n=3;
<a name="l00387"></a>00387   <span class="keywordtype">double</span> val=0.025;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389   cross_n_noise_val(in, out, n, val);
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 <span class="keywordtype">void</span>
<a name="l00393"></a>00393 cross_2_noise_001(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396   <span class="keywordtype">int</span> n=2;
<a name="l00397"></a>00397   <span class="keywordtype">double</span> val=0.001;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   cross_n_noise_val(in, out, n, val);
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="keywordtype">void</span>
<a name="l00403"></a>00403 cross_2_noise_01(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406   <span class="keywordtype">int</span> n=2;
<a name="l00407"></a>00407   <span class="keywordtype">double</span> val=0.01;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409   cross_n_noise_val(in, out, n, val);
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="keywordtype">void</span>
<a name="l00413"></a>00413 cross_2_noise_1(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 {
<a name="l00416"></a>00416   <span class="keywordtype">int</span> n=2;
<a name="l00417"></a>00417   <span class="keywordtype">double</span> val=0.1;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   cross_n_noise_val(in, out, n, val);
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 <span class="keywordtype">void</span>
<a name="l00423"></a>00423 cross_n_noise_val(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out, <span class="keywordtype">int</span> n, <span class="keywordtype">double</span> val)
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426   <span class="keywordtype">int</span> i,j;
<a name="l00427"></a>00427   <span class="keywordtype">double</span> v1,v2,v3;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   j = 0;
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   in[++j] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.0,0.5774);
<a name="l00432"></a>00432   in[++j] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.0,0.5774);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   <span class="keywordflow">for</span> (i=1; i&lt;=n; ++i) {
<a name="l00435"></a>00435     in[++j] = <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(0.0,val)+(i-1);
<a name="l00436"></a>00436   }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438   v1 = exp(-sqr(in[1])*10);
<a name="l00439"></a>00439   v2 = exp(-sqr(in[2])*50);
<a name="l00440"></a>00440   v3 = exp(-(sqr(in[1])+sqr(in[2]))*5) * 1.25;
<a name="l00441"></a>00441   out[1] = v1;
<a name="l00442"></a>00442   <span class="keywordflow">if</span> (v2 &gt; out[1]) out[1] = v2;
<a name="l00443"></a>00443   <span class="keywordflow">if</span> (v3 &gt; out[1]) out[1] = v3;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   out[1] += <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(0.0,0.05);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="keywordtype">void</span>
<a name="l00450"></a>00450 cross_region(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out, <span class="keywordtype">double</span> *r_min, <span class="keywordtype">double</span> *r_max)
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453   <span class="keywordtype">int</span> i,j;
<a name="l00454"></a>00454   <span class="keywordtype">double</span> v1,v2,v3;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456   j = 0;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   ++j;
<a name="l00459"></a>00459   in[j] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.0,0.5774)*(r_max[j]-r_min[j])/2.+(r_max[j]+r_min[j])/2.;
<a name="l00460"></a>00460   ++j;
<a name="l00461"></a>00461   in[j] = <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.0,0.5774)*(r_max[j]-r_min[j])/2.+(r_max[j]+r_min[j])/2.;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   v1 = exp(-sqr(in[1])*10);
<a name="l00464"></a>00464   v2 = exp(-sqr(in[2])*50);
<a name="l00465"></a>00465   v3 = exp(-(sqr(in[1])+sqr(in[2]))*5) * 1.25;
<a name="l00466"></a>00466   out[1] = v1;
<a name="l00467"></a>00467   <span class="keywordflow">if</span> (v2 &gt; out[1]) out[1] = v2;
<a name="l00468"></a>00468   <span class="keywordflow">if</span> (v3 &gt; out[1]) out[1] = v3;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470   out[1] += <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(0.0,0.1);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="keywordtype">void</span> 
<a name="l00476"></a>00476 cross_2_brown_10(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00477"></a>00477 {
<a name="l00478"></a>00478   <span class="keywordtype">int</span> n=0;
<a name="l00479"></a>00479   <span class="keywordtype">int</span> i;
<a name="l00480"></a>00480   <span class="keywordtype">double</span> val=0.0;
<a name="l00481"></a>00481   <span class="keyword">static</span> <span class="keywordtype">double</span> x[2+1];
<a name="l00482"></a>00482   <span class="keywordtype">double</span> mult = 0.1;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   cross_n_noise_val(in, out, n, val);
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="keywordflow">for</span> (i=1; i&lt;=2; ++i) {
<a name="l00487"></a>00487     x[i] = cross_brown(x[i]);
<a name="l00488"></a>00488     in[2+i] = x[i]*mult+(i-1);
<a name="l00489"></a>00489   }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="keywordtype">void</span> 
<a name="l00494"></a>00494 cross_2_brown_50(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496   <span class="keywordtype">int</span> n=0;
<a name="l00497"></a>00497   <span class="keywordtype">int</span> i;
<a name="l00498"></a>00498   <span class="keywordtype">double</span> val=0.0;
<a name="l00499"></a>00499   <span class="keyword">static</span> <span class="keywordtype">double</span> x[2+1];
<a name="l00500"></a>00500   <span class="keywordtype">double</span> mult = 0.50;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502   cross_n_noise_val(in, out, n, val);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordflow">for</span> (i=1; i&lt;=2; ++i) {
<a name="l00505"></a>00505     x[i] = cross_brown(x[i]);
<a name="l00506"></a>00506     in[2+i] = x[i]*mult+(i-1);
<a name="l00507"></a>00507   }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="keywordtype">void</span> 
<a name="l00512"></a>00512 cross_2_brown_25(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00513"></a>00513 {
<a name="l00514"></a>00514   <span class="keywordtype">int</span> n=0;
<a name="l00515"></a>00515   <span class="keywordtype">int</span> i;
<a name="l00516"></a>00516   <span class="keywordtype">double</span> val=0.0;
<a name="l00517"></a>00517   <span class="keyword">static</span> <span class="keywordtype">double</span> x[2+1];
<a name="l00518"></a>00518   <span class="keywordtype">double</span> mult = 0.25;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520   cross_n_noise_val(in, out, n, val);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522   <span class="keywordflow">for</span> (i=1; i&lt;=2; ++i) {
<a name="l00523"></a>00523     x[i] = cross_brown(x[i]);
<a name="l00524"></a>00524     in[2+i] = x[i]*mult+(i-1);
<a name="l00525"></a>00525   }
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529 <span class="keywordtype">void</span> 
<a name="l00530"></a>00530 cross_2_noise_2_brown(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00531"></a>00531 {
<a name="l00532"></a>00532   <span class="keywordtype">int</span> n=2;
<a name="l00533"></a>00533   <span class="keywordtype">int</span> i;
<a name="l00534"></a>00534   <span class="keywordtype">double</span> val=0.01;
<a name="l00535"></a>00535   <span class="keyword">static</span> <span class="keywordtype">double</span> x[2+1];
<a name="l00536"></a>00536   <span class="keywordtype">double</span> mult = 0.25;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538   cross_n_noise_val(in, out, n, val);
<a name="l00539"></a>00539 
<a name="l00540"></a>00540   <span class="keywordflow">for</span> (i=1; i&lt;=2; ++i) {
<a name="l00541"></a>00541     x[i] = cross_brown(x[i]);
<a name="l00542"></a>00542     in[4+i] = x[i]*mult+(i-1);
<a name="l00543"></a>00543   }
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="keywordtype">void</span> 
<a name="l00547"></a>00547 cross_1_noise_1_brown_1_duplicate(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00548"></a>00548 {
<a name="l00549"></a>00549   <span class="keywordtype">int</span> n=1;
<a name="l00550"></a>00550   <span class="keywordtype">int</span> i;
<a name="l00551"></a>00551   <span class="keywordtype">double</span> val=0.0316; <span class="comment">/* this is var=0.001 */</span>
<a name="l00552"></a>00552   <span class="keyword">static</span> <span class="keywordtype">double</span> x[1+1];
<a name="l00553"></a>00553   <span class="keywordtype">double</span> mult = 0.1;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555   cross_n_noise_val(in, out, n, val);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557   in[3] += 0.1;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="keywordflow">for</span> (i=1; i&lt;=1; ++i) {
<a name="l00560"></a>00560     x[i] = cross_brown(x[i]);
<a name="l00561"></a>00561     in[3+i] = x[i]*mult+(i-1);
<a name="l00562"></a>00562   }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564   in[5] = in[1] + <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(0.0,0.05);
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 <span class="keywordtype">double</span>
<a name="l00569"></a>00569 cross_brown(<span class="keywordtype">double</span> x)
<a name="l00570"></a>00570 {
<a name="l00571"></a>00571   <span class="keywordtype">int</span> i;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573   x += <a class="code" href="utility_8c.html#3dc30c02cd0d0f7c85119f107439fe4e">uniform</a>(0.0,0.5774)*0.1;
<a name="l00574"></a>00574   <span class="keywordflow">if</span> (x &gt;  1.0) x =  1.0 - (x - 1.0);
<a name="l00575"></a>00575   <span class="keywordflow">if</span> (x &lt; -1.0) x = -1.0 - (x + 1.0);
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="keywordflow">return</span> x;
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 <span class="keywordtype">void</span>
<a name="l00581"></a>00581 inv_dyn_2DOF(<span class="keywordtype">double</span> *in, <span class="keywordtype">double</span> *out)
<a name="l00582"></a>00582 {
<a name="l00583"></a>00583 
<a name="l00584"></a>00584   <span class="keyword">static</span> <span class="keywordtype">double</span> t=0.0;
<a name="l00585"></a>00585   <span class="keywordtype">double</span>        dt = .01;
<a name="l00586"></a>00586   <span class="keywordtype">double</span>        ltau,lamp;
<a name="l00587"></a>00587   <span class="keywordtype">double</span>        init_tau = 2.,tau;
<a name="l00588"></a>00588   <span class="keywordtype">double</span>        amplitude = 0.06;
<a name="l00589"></a>00589   <span class="keywordtype">double</span>        x ,y;
<a name="l00590"></a>00590   <span class="keywordtype">double</span>        setx= -.3,sety=.3;
<a name="l00591"></a>00591   <span class="keyword">static</span> <span class="keywordtype">double</span>        last_th1, last_th2;
<a name="l00592"></a>00592   <span class="keyword">static</span> <span class="keywordtype">double</span>        last_th1d, last_th2d;
<a name="l00593"></a>00593   <span class="keyword">static</span> <span class="keywordtype">int</span>           firsttime = TRUE;
<a name="l00594"></a>00594   <span class="keywordtype">int</span>                  count=0, i;
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 
<a name="l00597"></a>00597  AGAIN:
<a name="l00598"></a>00598 
<a name="l00599"></a>00599   <span class="keywordflow">if</span> (firsttime &amp;&amp; count == 0) {
<a name="l00600"></a>00600     last_th1 = setx;
<a name="l00601"></a>00601     last_th2 = sety;
<a name="l00602"></a>00602     last_th1d = 0;
<a name="l00603"></a>00603     last_th2d = 0;
<a name="l00604"></a>00604     t = 0.0;
<a name="l00605"></a>00605   }
<a name="l00606"></a>00606 
<a name="l00607"></a>00607   tau = init_tau;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609   ltau =  tau*PI/2.;;
<a name="l00610"></a>00610   lamp =  amplitude*1.5;
<a name="l00611"></a>00611   setx += sin(2.*Pi/ltau * t) * lamp;
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   ltau =  tau*2.*PI;
<a name="l00614"></a>00614   lamp =  amplitude*0.25;
<a name="l00615"></a>00615   sety  += sin(2.*Pi/ltau * t) * lamp;
<a name="l00616"></a>00616 
<a name="l00617"></a>00617   ltau =  tau/2.;
<a name="l00618"></a>00618   lamp =  amplitude;
<a name="l00619"></a>00619   x  = setx + sin(2.*Pi/ltau * t) * lamp;
<a name="l00620"></a>00620 
<a name="l00621"></a>00621   ltau =  tau;
<a name="l00622"></a>00622   lamp =  amplitude*1.5;
<a name="l00623"></a>00623   y = sety + sin(2.*Pi/ltau * t) * lamp;
<a name="l00624"></a>00624 
<a name="l00625"></a>00625   inverse_kinematics_2DOF(x,y,&amp;in[1],&amp;in[2]);
<a name="l00626"></a>00626 
<a name="l00627"></a>00627   in[3] = (in[1] - last_th1)/dt;
<a name="l00628"></a>00628   in[4] = (in[2] - last_th2)/dt;
<a name="l00629"></a>00629   in[5] = (in[3] - last_th1d)/dt;
<a name="l00630"></a>00630   in[6] = (in[4] - last_th2d)/dt;
<a name="l00631"></a>00631 
<a name="l00632"></a>00632   last_th1 = in[1];
<a name="l00633"></a>00633   last_th2 = in[2];
<a name="l00634"></a>00634   last_th1d = in[3];
<a name="l00635"></a>00635   last_th2d = in[4];
<a name="l00636"></a>00636 
<a name="l00637"></a>00637   inverse_dynamics_2DOF(in[1],in[2],in[3],in[4],in[5],in[6],&amp;out[1],&amp;out[2]);
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   out[1] = <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(out[1],.03);
<a name="l00640"></a>00640   out[2] = <a class="code" href="utility_8c.html#af8008184129afffcccf82b69095dad4">gaussian</a>(out[2],.03);
<a name="l00641"></a>00641 
<a name="l00642"></a>00642   t += dt;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644   <span class="keywordflow">if</span> (firsttime) {
<a name="l00645"></a>00645     <span class="comment">/* I need the numerical derivatives straightened out */</span>
<a name="l00646"></a>00646     <span class="keywordflow">if</span> (++count &gt;= 10) firsttime = FALSE;
<a name="l00647"></a>00647     tau = init_tau;
<a name="l00648"></a>00648     <span class="keywordflow">goto</span> AGAIN;
<a name="l00649"></a>00649   }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651 <span class="comment">/*</span>
<a name="l00652"></a>00652 <span class="comment">  if (fabs(fmod(t,0.25)) &lt; 0.1*dt) {</span>
<a name="l00653"></a>00653 <span class="comment">    printf("%f %f     ",x,y);</span>
<a name="l00654"></a>00654 <span class="comment">    for (i=1; i&lt;=6; ++i) {</span>
<a name="l00655"></a>00655 <span class="comment">      printf("%f ",in[i]);</span>
<a name="l00656"></a>00656 <span class="comment">    }</span>
<a name="l00657"></a>00657 <span class="comment">    for (i=1; i&lt;=2; ++i) {</span>
<a name="l00658"></a>00658 <span class="comment">      printf("%f ",out[i]);</span>
<a name="l00659"></a>00659 <span class="comment">    }</span>
<a name="l00660"></a>00660 <span class="comment">    printf("\n");</span>
<a name="l00661"></a>00661 <span class="comment">  }</span>
<a name="l00662"></a>00662 <span class="comment">  setx= .3;sety=.3;</span>
<a name="l00663"></a>00663 <span class="comment">  goto AGAIN;</span>
<a name="l00664"></a>00664 <span class="comment">*/</span>
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 }
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 <span class="comment">/***************************************************************************</span>
<a name="l00670"></a>00670 <span class="comment"> ***************************************************************************</span>
<a name="l00671"></a>00671 <span class="comment"> Function Name  : inverse_dynamics_2DOF</span>
<a name="l00672"></a>00672 <span class="comment"> Date           : January, 1994</span>
<a name="l00673"></a>00673 <span class="comment"> </span>
<a name="l00674"></a>00674 <span class="comment"> Remarks:</span>
<a name="l00675"></a>00675 <span class="comment"> </span>
<a name="l00676"></a>00676 <span class="comment"> the inverse dynamics of a planar 2DOF arm</span>
<a name="l00677"></a>00677 <span class="comment"> </span>
<a name="l00678"></a>00678 <span class="comment"> ***************************************************************************</span>
<a name="l00679"></a>00679 <span class="comment"> Paramters:  (i/o = input/output)</span>
<a name="l00680"></a>00680 <span class="comment"> </span>
<a name="l00681"></a>00681 <span class="comment"> th1,th1d,th1dd (i): states and accelerations for first joint</span>
<a name="l00682"></a>00682 <span class="comment"> th2,th2d,th2dd (i): states and accelerations for second joint</span>
<a name="l00683"></a>00683 <span class="comment"> control1       (o): command for first joint</span>
<a name="l00684"></a>00684 <span class="comment"> control2       (o): command for second joint </span>
<a name="l00685"></a>00685 <span class="comment"> </span>
<a name="l00686"></a>00686 <span class="comment"> **************************************************************************/</span>
<a name="l00687"></a>00687 <span class="keywordtype">void</span>
<a name="l00688"></a>00688 inverse_dynamics_2DOF(<span class="keywordtype">double</span> th1, <span class="keywordtype">double</span> th2, <span class="keywordtype">double</span> th1d, <span class="keywordtype">double</span> th2d,
<a name="l00689"></a>00689                       <span class="keywordtype">double</span> th1dd, <span class="keywordtype">double</span> th2dd, <span class="keywordtype">double</span> *control1,
<a name="l00690"></a>00690                       <span class="keywordtype">double</span> *control2)
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 {
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   <span class="keywordtype">double</span>   m1 = 15.0;
<a name="l00695"></a>00695   <span class="keywordtype">double</span>   m2 = 15.0;
<a name="l00696"></a>00696   <span class="keywordtype">double</span>   Inertia1 = 0.05;
<a name="l00697"></a>00697   <span class="keywordtype">double</span>   Inertia2 = 0.05;
<a name="l00698"></a>00698   <span class="keywordtype">double</span>   s1 = 0.15;
<a name="l00699"></a>00699   <span class="keywordtype">double</span>   s2 = 0.15;
<a name="l00700"></a>00700   <span class="keywordtype">double</span>   l = .30;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702   th1 -= PI/2.;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704   *control1 = 
<a name="l00705"></a>00705     Power(l,2)*m2*th1dd + (Inertia1 + m1*Power(s1,2))*th1dd + 
<a name="l00706"></a>00706       (Inertia2 + m2*Power(s2,2))*(th1dd + th2dd) + G*m1*s1*Cos(th1) + 
<a name="l00707"></a>00707         l*m2*s2*th1dd*Cos(th2) + l*m2*s2*(th1dd + th2dd)*Cos(th2) + 
<a name="l00708"></a>00708           G*m2*(l*Cos(th1) + s2*Cos(th1 + th2)) -l*m2*s2*th1d*th2d*Sin(th2) - 
<a name="l00709"></a>00709             l*m2*s2*th2d*(th1d + th2d)*Sin(th2);
<a name="l00710"></a>00710 
<a name="l00711"></a>00711   *control2 = 
<a name="l00712"></a>00712     Inertia2*th1dd + m2*Power(s2,2)*th1dd + Inertia2*th2dd + 
<a name="l00713"></a>00713       m2*Power(s2,2)*th2dd + l*m2*s2*th1dd*Cos(th2) + G*m2*s2*Cos(th1+ th2) + 
<a name="l00714"></a>00714         l*m2*s2*Power(th1d,2)*Sin(th2);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 }
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 <span class="comment">/***************************************************************************</span>
<a name="l00720"></a>00720 <span class="comment"> ***************************************************************************</span>
<a name="l00721"></a>00721 <span class="comment"> Function Name  : forward_dynamics_2DOF</span>
<a name="l00722"></a>00722 <span class="comment"> Date           : January, 1994</span>
<a name="l00723"></a>00723 <span class="comment"> </span>
<a name="l00724"></a>00724 <span class="comment"> Remarks:</span>
<a name="l00725"></a>00725 <span class="comment"> </span>
<a name="l00726"></a>00726 <span class="comment"> the inverse dynamics of a planar 2DOF arm</span>
<a name="l00727"></a>00727 <span class="comment"> </span>
<a name="l00728"></a>00728 <span class="comment"> ***************************************************************************</span>
<a name="l00729"></a>00729 <span class="comment"> Paramters:  (i/o = input/output)</span>
<a name="l00730"></a>00730 <span class="comment"> </span>
<a name="l00731"></a>00731 <span class="comment"> th1,th1d       (i): states and accelerations for first joint</span>
<a name="l00732"></a>00732 <span class="comment"> th2,th2d       (i): states and accelerations for second joint</span>
<a name="l00733"></a>00733 <span class="comment"> control1       (i): command for first joint</span>
<a name="l00734"></a>00734 <span class="comment"> control2       (i): command for second joint </span>
<a name="l00735"></a>00735 <span class="comment"> dt             (i): integration step</span>
<a name="l00736"></a>00736 <span class="comment"> nth1,nth1d     (o): the new states for the first joint</span>
<a name="l00737"></a>00737 <span class="comment"> nth2,nth2d     (o): the new states for the second joint</span>
<a name="l00738"></a>00738 <span class="comment"> </span>
<a name="l00739"></a>00739 <span class="comment"> **************************************************************************/</span>
<a name="l00740"></a>00740 <span class="keywordtype">void</span>
<a name="l00741"></a>00741 forward_dynamics_2DOF(<span class="keywordtype">double</span> th1, <span class="keywordtype">double</span> th2, <span class="keywordtype">double</span> th1d, <span class="keywordtype">double</span> th2d,
<a name="l00742"></a>00742                       <span class="keywordtype">double</span> control1, <span class="keywordtype">double</span> control2, <span class="keywordtype">double</span> dt,
<a name="l00743"></a>00743                       <span class="keywordtype">double</span> *nth1, <span class="keywordtype">double</span> *nth2, <span class="keywordtype">double</span> *nth1d,<span class="keywordtype">double</span> *nth2d)
<a name="l00744"></a>00744 
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746 
<a name="l00747"></a>00747   <span class="keywordtype">double</span>   m1 = 15.0;
<a name="l00748"></a>00748   <span class="keywordtype">double</span>   m2 = 15.0;
<a name="l00749"></a>00749   <span class="keywordtype">double</span>   Inertia1 = 0.05;
<a name="l00750"></a>00750   <span class="keywordtype">double</span>   Inertia2 = 0.05;
<a name="l00751"></a>00751   <span class="keywordtype">double</span>   s1 = 0.15;
<a name="l00752"></a>00752   <span class="keywordtype">double</span>   s2 = 0.15;
<a name="l00753"></a>00753   <span class="keywordtype">double</span>   l = .30;
<a name="l00754"></a>00754   <span class="keywordtype">double</span>   th1dd, th2dd;
<a name="l00755"></a>00755 
<a name="l00756"></a>00756   th1 -= PI/2.;
<a name="l00757"></a>00757 
<a name="l00758"></a>00758   th1dd =  
<a name="l00759"></a>00759     -((-((-Inertia2 - m2*Power(s2,2) - l*m2*s2*Cos(th2))*
<a name="l00760"></a>00760          (control2 - G*m2*s2*Cos(th2 + th1) - l*m2*s2*Power(th1d,2)*Sin(th2))
<a name="l00761"></a>00761          ) + (-Inertia2 - m2*Power(s2,2))*
<a name="l00762"></a>00762        (control1 - G*l*m2*Cos(th1) - G*m1*s1*Cos(th1) - 
<a name="l00763"></a>00763         G*m2*s2*Cos(th2 + th1) + 2*l*m2*s2*th1d*th2d*Sin(th2) + 
<a name="l00764"></a>00764         l*m2*s2*Power(th2d,2)*Sin(th2)))/
<a name="l00765"></a>00765     (Inertia1*Inertia2 + Inertia2*Power(l,2)*m2 + Inertia2*m1*Power(s1,2) + 
<a name="l00766"></a>00766      Inertia1*m2*Power(s2,2) + Power(l,2)*Power(m2,2)*Power(s2,2) + 
<a name="l00767"></a>00767      m1*m2*Power(s1,2)*Power(s2,2) - 
<a name="l00768"></a>00768      Power(l,2)*Power(m2,2)*Power(s2,2)*Power(Cos(th2),2)));
<a name="l00769"></a>00769 
<a name="l00770"></a>00770   th2dd = 
<a name="l00771"></a>00771     -((control2 - G*m2*s2*Cos(th2 + th1) - l*m2*s2*Power(th1d,2)*Sin(th2))/
<a name="l00772"></a>00772       (-Inertia2 - m2*Power(s2,2))) + 
<a name="l00773"></a>00773         (-Inertia2 - m2*Power(s2,2) - l*m2*s2*Cos(th2))*
<a name="l00774"></a>00774           (-((-Inertia2 - m2*Power(s2,2) - l*m2*s2*Cos(th2))*
<a name="l00775"></a>00775              (control2 - G*m2*s2*Cos(th2 + th1) - l*m2*s2*Power(th1d,2)*Sin(th2))
<a name="l00776"></a>00776              ) + (-Inertia2 - m2*Power(s2,2))*
<a name="l00777"></a>00777        (control1 - G*l*m2*Cos(th1) - G*m1*s1*Cos(th1) - 
<a name="l00778"></a>00778         G*m2*s2*Cos(th2 + th1) + 2*l*m2*s2*th1d*th2d*Sin(th2) + 
<a name="l00779"></a>00779         l*m2*s2*Power(th2d,2)*Sin(th2)))/
<a name="l00780"></a>00780           ((-Inertia2 - m2*Power(s2,2))*
<a name="l00781"></a>00781            (Inertia1*Inertia2 + Inertia2*Power(l,2)*m2 + Inertia2*m1*Power(s1,2) + 
<a name="l00782"></a>00782             Inertia1*m2*Power(s2,2) + Power(l,2)*Power(m2,2)*Power(s2,2) + 
<a name="l00783"></a>00783             m1*m2*Power(s1,2)*Power(s2,2) - 
<a name="l00784"></a>00784             Power(l,2)*Power(m2,2)*Power(s2,2)*Power(Cos(th2),2)));
<a name="l00785"></a>00785             
<a name="l00786"></a>00786   *nth1  = th1d * dt + th1 + PI/2.;
<a name="l00787"></a>00787   *nth2  = th2d * dt + th2;
<a name="l00788"></a>00788   *nth1d = th1dd * dt + th1d;
<a name="l00789"></a>00789   *nth2d = th2dd * dt + th2d;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 }
<a name="l00793"></a>00793 
<a name="l00794"></a>00794 <span class="comment">/***************************************************************************</span>
<a name="l00795"></a>00795 <span class="comment"> ***************************************************************************</span>
<a name="l00796"></a>00796 <span class="comment"> Function Name  : inverse_kinematics_2DOF</span>
<a name="l00797"></a>00797 <span class="comment"> Date           : January, 1994</span>
<a name="l00798"></a>00798 <span class="comment"> </span>
<a name="l00799"></a>00799 <span class="comment"> Remarks:</span>
<a name="l00800"></a>00800 <span class="comment"> </span>
<a name="l00801"></a>00801 <span class="comment"> the inverse kinematics of a planar 2DOF arm</span>
<a name="l00802"></a>00802 <span class="comment"> </span>
<a name="l00803"></a>00803 <span class="comment"> ***************************************************************************</span>
<a name="l00804"></a>00804 <span class="comment"> Paramters:  (i/o = input/output)</span>
<a name="l00805"></a>00805 <span class="comment"> </span>
<a name="l00806"></a>00806 <span class="comment"> x,y            (i): cartesian inputs</span>
<a name="l00807"></a>00807 <span class="comment"> th1,th2        (o): joint states (one solution only)</span>
<a name="l00808"></a>00808 <span class="comment"> </span>
<a name="l00809"></a>00809 <span class="comment"> **************************************************************************/</span>
<a name="l00810"></a>00810 <span class="keywordtype">void</span>
<a name="l00811"></a>00811 inverse_kinematics_2DOF(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> *th1, <span class="keywordtype">double</span> *th2)
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 {
<a name="l00814"></a>00814 
<a name="l00815"></a>00815   <span class="keywordtype">double</span>   l = .30;
<a name="l00816"></a>00816   <span class="keywordtype">double</span>   dist;
<a name="l00817"></a>00817   <span class="keywordtype">double</span>   angle1, angle2;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819   dist = sqrt(sqr(x) + sqr(y));
<a name="l00820"></a>00820   angle1 = acos(x/dist);
<a name="l00821"></a>00821   <span class="keywordflow">if</span> (y &lt; 0.0) angle1 *= -1.;
<a name="l00822"></a>00822   angle2 = acos(dist/2./l);
<a name="l00823"></a>00823   
<a name="l00824"></a>00824   *th1 = angle1-angle2+PI/2.;
<a name="l00825"></a>00825   *th2 = 2.*angle2;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829  
<a name="l00830"></a>00830 <span class="comment">/***************************************************************************</span>
<a name="l00831"></a>00831 <span class="comment"> ***************************************************************************</span>
<a name="l00832"></a>00832 <span class="comment"> Function Name  : forward_kinematics_2DOF</span>
<a name="l00833"></a>00833 <span class="comment"> Date           : January, 1994</span>
<a name="l00834"></a>00834 <span class="comment"> </span>
<a name="l00835"></a>00835 <span class="comment"> Remarks:</span>
<a name="l00836"></a>00836 <span class="comment"> </span>
<a name="l00837"></a>00837 <span class="comment"> the forward kinematics of a planar 2DOF arm</span>
<a name="l00838"></a>00838 <span class="comment"> </span>
<a name="l00839"></a>00839 <span class="comment"> ***************************************************************************</span>
<a name="l00840"></a>00840 <span class="comment"> Paramters:  (i/o = input/output)</span>
<a name="l00841"></a>00841 <span class="comment"> </span>
<a name="l00842"></a>00842 <span class="comment"> th1,th2        (i): joint states (one solution only)</span>
<a name="l00843"></a>00843 <span class="comment"> x,y            (o): cartesian inputs</span>
<a name="l00844"></a>00844 <span class="comment"> </span>
<a name="l00845"></a>00845 <span class="comment"> **************************************************************************/</span>
<a name="l00846"></a>00846 <span class="keywordtype">void</span>
<a name="l00847"></a>00847 forward_kinematics_2DOF(<span class="keywordtype">double</span> th1, <span class="keywordtype">double</span> th2, <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y)
<a name="l00848"></a>00848 
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850 
<a name="l00851"></a>00851   <span class="keywordtype">double</span>   l = .30;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   th1 -= PI/2.;
<a name="l00854"></a>00854   *x = l * cos(th1) + l * cos(th1+th2);
<a name="l00855"></a>00855   *y = l * sin(th1) + l * sin(th1+th2);
<a name="l00856"></a>00856 
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859  
<a name="l00860"></a>00860  
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri May 7 22:42:08 2010 for UtilitiesLibrary by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
